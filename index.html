<!-- cat fortress 2 :3 -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cat Fortress 2</title>
<style>
  body { margin:0; overflow:hidden; background:#cceeff; }
  canvas { display:block; margin:0 auto; background:#cceeff; }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>
<script>
/** Cat Fortress 2 - lil catboy burrito edition 🥺💖 */

const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');

canvas.width = 800;
canvas.height = 400;

// images
const floorImg = new Image();
floorImg.src = 'floor.png'; // your 512x127 floor tile
const stairImg = new Image();
stairImg.src = 'stair.png'; // 40x32 stairs

// player
const player = {
    x: 100,
    y: 0,
    width: 32,
    height: 32,
    vy: 0,
    onGround: false
};

// floor
const floor = { x:0, y:300, width:canvas.width, height:32 };

// stairs array
const stairs = [
    {x:0, y:0, width:40, height:32},
    {x:0, y:0, width:40, height:32},
    {x:0, y:0, width:40, height:32}
];

// keyboard
const keys = {};
window.addEventListener('keydown', e => keys[e.key] = true);
window.addEventListener('keyup', e => keys[e.key] = false);

function update() {
    // horizontal
    if(keys['a']) player.x -= 3;
    if(keys['d']) player.x += 3;

    // gravity
    player.vy += 0.5;
    player.y += player.vy;

    // floor collision
    if(player.y + player.height > floor.y) {
        player.y = floor.y - player.height;
        player.vy = 0;
        player.onGround = true;
    } else {
        player.onGround = false;
    }

    // stairs collision
    for(let stair of stairs) {
        if(player.x + player.width > stair.x && player.x < stair.x + stair.width &&
           player.y + player.height > stair.y && player.y + player.height < stair.y + stair.height + 10 &&
           player.vy >=0) {
            player.y = stair.y - player.height;
            player.vy = 0;
            player.onGround = true;
        }
    }

    // jump
    if(keys['w'] && player.onGround) {
        player.vy = -10;
        player.onGround = false;
    }
}

function draw() {
    ctx.clearRect(0,0,canvas.width, canvas.height);

    // draw repeating floor
    let floorRepeat = Math.ceil(canvas.width / floorImg.width);
    for(let i=0;i<floorRepeat;i++){
        ctx.drawImage(floorImg, i*floorImg.width, floor.y, floorImg.width, floor.height);
    }

    // draw stairs stacked properly
    for(let i=0;i<stairs.length;i++){
        let stair = stairs[i];
        if(i === 0){
            stair.x = 200;
            stair.y = floor.y - stair.height;
        } else {
            stair.x = stairs[i-1].x;
            stair.y = stairs[i-1].y - stair.height;
        }
        ctx.drawImage(stairImg, stair.x, stair.y, stair.width, stair.height);
    }

    // draw cat player
    ctx.font = '32px sans-serif';
    ctx.fillText('🐱', player.x, player.y + player.height);
}

function gameLoop() {
    update();
    draw();
    requestAnimationFrame(gameLoop);
}

gameLoop();

</script>
</body>
</html>