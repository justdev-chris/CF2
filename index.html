<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cat Fortress 2</title>
<style>
  body {
    margin: 0;
    overflow: hidden;
    background: #87CEEB;
  }
  canvas {
    display: block;
    background: #87CEEB;
  }
</style>
</head>
<body>
<canvas id="game"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
canvas.width = 800;
canvas.height = 400;

// Load images
const floorImg = new Image();
floorImg.src = 'floor.png';
const stairImg = new Image();
stairImg.src = 'stairs.png';

// Player
const player = {
  x: 50,
  y: 300,
  width: 20,
  height: 20,
  dy: 0,
  speed: 3,
  onGround: false
};

// Floor
const floor = {
  x: 0,
  y: 350,
  width: canvas.width,
  height: 50
};

// Stairs manually aligned
const stairs = [
  {x: 200, y: 300, width: 40, height: 32},
  {x: 240, y: 268, width: 40, height: 32},
  {x: 280, y: 236, width: 40, height: 32},
];

// Keys
const keys = {};
document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

// Game loop
function update() {
  // Horizontal movement
  if (keys['a']) player.x -= player.speed;
  if (keys['d']) player.x += player.speed;

  // Gravity
  player.dy += 0.8;
  player.y += player.dy;

  player.onGround = false;

  // Floor collision
  if (!keys['shift']) {
    if (player.x < floor.x + floor.width &&
        player.x + player.width > floor.x &&
        player.y + player.height > floor.y &&
        player.y + player.height < floor.y + floor.height) {
      player.y = floor.y - player.height;
      player.dy = 0;
      player.onGround = true;
    }

    // Stairs collision
    for (const stair of stairs) {
      if (player.x < stair.x + stair.width &&
          player.x + player.width > stair.x &&
          player.y + player.height > stair.y &&
          player.y + player.height < stair.y + stair.height) {
        player.y = stair.y - player.height;
        player.dy = 0;
        player.onGround = true;
      }
    }
  }

  // Jump
  if (keys['w'] && player.onGround) {
    player.dy = -12;
    player.onGround = false;
  }
}

// Draw loop
function draw() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw floor repeated
  const floorTiles = Math.ceil(floor.width / floorImg.width);
  for (let i = 0; i < floorTiles; i++) {
    ctx.drawImage(floorImg, floor.x + i * floorImg.width, floor.y, floorImg.width, floor.height);
  }

  // Draw stairs
  for (const stair of stairs) {
    ctx.drawImage(stairImg, stair.x, stair.y, stair.width, stair.height);
  }

  // Draw player as cat emoji
  ctx.font = `${player.height}px Arial`;
  ctx.fillText('ðŸ±', player.x, player.y + player.height);
}

function gameLoop() {
  update();
  draw();
  requestAnimationFrame(gameLoop);
}

floorImg.onload = () => {
  stairImg.onload = () => {
    gameLoop();
  };
};
</script>
</body>
</html>