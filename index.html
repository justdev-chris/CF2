<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Cat Fortress 2</title>
<style>
  canvas {
    background: #87ceeb;
    display: block;
    margin: 0 auto;
  }
</style>
</head>
<body>
<canvas id="game" width="800" height="400"></canvas>
<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

// Images
const floorImg = new Image();
floorImg.src = 'floor.png'; // 512x127
const stairImg = new Image();
stairImg.src = 'stairs.png'; // 40x32

// Player
const player = {
  x: 50,
  y: 250,
  width: 30, // bigger cat
  height: 30,
  dy: 0,
  speed: 3,
  jumpPower: -7,
  onGround: false
};

// Floor and stairs data
const floor = {x:0, y:canvas.height - 64, width:canvas.width, height:32}; // thin but use image size ratio
const stairs = [
  {x: 300, y: floor.y - 32, width:40, height:32},
  {x: 340, y: floor.y - 64, width:40, height:32}, 
  {x: 380, y: floor.y - 96, width:40, height:32} // manually lined up
];

let keys = {};

document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

function update() {
  // Horizontal movement
  if(keys['a']) player.x -= player.speed;
  if(keys['d']) player.x += player.speed;

  // Jump
  if((keys['w'] || keys[' ']) && player.onGround){
    player.dy = player.jumpPower;
    player.onGround = false;
  }

  // Gravity
  player.dy += 0.5;
  player.y += player.dy;

  // Collision with floor
  player.onGround = false;
  if(player.x < floor.x + floor.width && player.x + player.width > floor.x &&
     player.y < floor.y + floor.height && player.y + player.height > floor.y){
    player.y = floor.y - player.height;
    player.dy = 0;
    player.onGround = true;
  }

  // Collision with stairs (shift noclip)
  stairs.forEach(s => {
    if(!(keys['shift']) &&
       player.x < s.x + s.width && player.x + player.width > s.x &&
       player.y < s.y + s.height && player.y + player.height > s.y){
      player.y = s.y - player.height;
      player.dy = 0;
      player.onGround = true;
    }
  });
}

function draw() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // Draw floor scaled thin but keep image aspect
  for(let i=0;i<canvas.width;i+=256){ 
    ctx.drawImage(floorImg, i, floor.y, 256, 32); // thin but correct aspect ratio
  }

  // Draw stairs scaled
  stairs.forEach(s => ctx.drawImage(stairImg, s.x, s.y, s.width, s.height));

  // Draw bigger cat player
  ctx.font = '30px serif';
  ctx.fillText('ðŸ˜º', player.x, player.y + player.height);
}

function loop() {
  update();
  draw();
  requestAnimationFrame(loop);
}

floorImg.onload = () => {
  stairImg.onload = () => {
    loop();
  }
}
</script>
</body>
</html>